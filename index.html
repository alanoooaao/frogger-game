<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title id='game-title'>Frogger</title>
    <!-- <meta http-equiv="Cache-Control" content="max-age=1800" />
    <meta http-equiv="last-modified" content="Fri Mar 24 2017 17:20:48 GMT+0800 (CST)"> -->
    <meta name="viewport" content="width=505,user-scalable=no">
	<meta name="format-detection" content="telephone=no">
    <meta http-equiv="Access-Control-Allow-Origin" content="anonymous">
    <!-- <link rel="stylesheet" href="css/style.css"> -->
    <!-- <link rel="stylesheet" href="minified/css/style.min.css"> -->
    <style>
        .btn-option,.txt{text-shadow:1px 1px #000}.board-title,body{text-align:center}.info-panel,.popup-board{color:#fff;user-select:none}*{margin:0;padding:0;list-style:none}body{font:sans-serif;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.top-bar{height:60px;line-height:60px;font:20px/60px sans-serif;background-color:#263;position:relative}.info-panel{width:505px;height:100%;margin:0 auto;position:relative;background-color:inherit;cursor:default}.menu-list,.progress-bar,.txt{position:absolute}.progress-bar{left:-1px;width:0;height:100%;z-index:1;background-color:#24a;border-right:1px solid #139}.txt{z-index:2}.score{left:0;padding-left:5px}.msg{left:120px;width:240px}.life{right:50px;padding-right:10px}.btn-menu{right:0;width:55px;height:60px;margin:0;padding:8px;border:none;border-radius:0;background-color:#181818}.btn-toggle:hover{background-color:#104008}.line{margin:6px;border-bottom:3px solid #fff;box-shadow:1px 1px #000}.menu-list{right:0;top:60px;width:120px;height:0;margin-top:-1px;background-color:inherit;overflow:hidden;transition:.2s}.btn-option{position:relative;height:60px;border:2px solid #251;border-bottom:none}.selection-list{position:absolute;right:119px;width:0;height:100%;border-top:2px solid #251;border-bottom:2px solid #251;background-color:#263;overflow:hidden;transition:80ms}.role-list{top:121px}.btn-selection{display:inline-block;float:right;border-left:2px solid #251}.btn-role{width:60px}.language-list{top:183px}.btn-language{width:100px}.popup-board{z-index:5;display:none;position:absolute;width:516px;height:750px;left:50%;margin-left:-258px;top:0;border-radius:5px;background-color:#000;opacity:.92;cursor:default}.board-title{position:relative;margin:20px auto;height:30px;line-height:30px;width:300px;font-size:18px;border:2px solid #555;border-radius:5px}.title-local,.title-world{display:inline-block;position:absolute;width:149px;height:100%}.title-world{left:0;border-right:1px solid #555;background-color:#4156a0}.title-local{right:0;border-left:1px solid #555}.board-content{margin:auto;overflow:hidden;position:relative;width:400px}.local-list,.remote-list{position:absolute;transition:.3s}.ranking-content{height:75%}.remote-list{left:0}.local-list{left:100%}.content-list{margin:auto;overflow-y:scroll;width:100%;height:100%}.record-role,.record-txt{display:inline-block;overflow:hidden}.btn-close{width:100px;height:40px;margin-top:30px;background-color:#263;color:#fff;font-size:18px;border-color:#222;border-radius:5px}.record{height:45px}.odd-row{background-color:#111}.first-record{height:60px;position:relative}.ranking-detail{position:absolute;right:5px;bottom:2px;height:20px;text-align:right;font-size:16px;color:#fbf850}.record-role{width:40px;height:40px;float:left;margin:auto 10px}.role-img{width:100%;height:170%;margin-top:-45%}.record-txt{height:45px;line-height:45px}.record-ranking{float:left;width:15px;padding-left:5px;text-align:center;overflow:visible}.record-name{float:left;width:200px;text-align:left}.record-score{float:right;margin-right:10px}.instruction-content{margin-top:40px;height:80%;overflow-y:scroll;text-align:left}.instruction-content h2{margin-top:25px;margin-bottom:10px;color:#fbf850}.instruction-content h4{margin:5px auto;color:#50b3fb}.instruction-content p{margin:10px auto}.instruction-content li{margin:10px auto;list-style-position:inside;list-style-type:circle}.operation-panel{display:none;position:absolute;width:360px;height:180px;bottom:10px;left:50%;margin-left:-180px;user-select:none}.arrow-down,.arrow-up{position:absolute;left:50%;margin-left:-50px;width:100px;height:75px;line-height:80px}.arrow-key{background-color:#24519d;color:#fff;text-align:center;font-size:48px;opacity:.7;border-radius:20px}.arrow-up{top:0}.arrow-down{bottom:0}.arrow-left,.arrow-right{position:absolute;top:50%;margin-top:-50px;width:100px;height:100px;line-height:100px}.arrow-left{left:0}.arrow-right{right:0}
    </style>
    <div id="shareImage" style="display: none;">
       	<img src="images/share.jpg" />
    </div>
</head>

<body>
    <div id="top-bar" class="top-bar">
        <div id="progress-bar" class="progress-bar"></div>
        <div class="info-panel">
            <p id="score" class="txt score"></p>
            <p id="msg" class="txt msg"></p>
            <p id="life" class="txt life"></p>
            <button id="btn-menu" class="txt btn-menu btn-toggle">
                <p class="line"></p>
                <p class="line"></p>
                <p class="line"></p>
            </button>
            <ul id="menu" class="menu-list">
                <li id="btn-ranking" class="btn-option btn-toggle"></li>
                <li id="btn-role" class="btn-option btn-toggle"></li>
                <li id="btn-language" class="btn-option btn-toggle"></li>
                <li id="btn-instruction" class="btn-option btn-toggle"></li>
                <li id="btn-restart" class="btn-option btn-toggle"></li>
            </ul>
            <ul id="role-list" class="role-list selection-list">
                <li class="btn-role btn-selection btn-toggle">
                    <img src="" alt="role No.5" id="role-4" class="role-img">
                </li>
                <li class="btn-role btn-selection btn-toggle">
                    <img src="" alt="role No.4" id="role-3" class="role-img">
                </li>
                <li class="btn-role btn-selection btn-toggle">
                    <img src="" alt="role No.3" id="role-2" class="role-img">
                </li>
                <li class="btn-role btn-selection btn-toggle">
                    <img src="" alt="role No.2" id="role-1" class="role-img">
                </li>
                <li class="btn-role btn-selection btn-toggle">
                    <img src="" alt="role No.1" id="role-0" class="role-img">
                </li>
            </ul>
            <ul id="language-list" class="language-list selection-list">
                <li class="btn-language btn-selection btn-toggle" id="language-1">中文</li>
                <li class="btn-language btn-selection btn-toggle" id="language-0">English</li>
            </ul>
        </div>
    </div>
    <div id="ranking-board" class="popup-board">
        <p class="board-title">
            <span id="title-world" class="title-world"></span>
            <span id="title-local" class="title-local"></span>
        </p>
        <div class="board-content ranking-content">
            <ul id="remote-list" class="content-list remote-list"></ul>
            <ul id="local-list" class="content-list local-list"></ul>
        </div>
        <button id="btn-close-ranking" class="btn-close btn-toggle">OK</button>
    </div>
    <div id="instruction-board" class="popup-board">
        <div class="board-content instruction-content">
            <h2>游戏目标</h2>
            <p>玩家通过上下左右四个方向键，操纵角色避开甲虫，到达河边。每次过河会有一定积分奖励，获取更高积分，登上全球排行榜</p>
            <h2>积分规则</h2>
            <p>随着时间推移和玩家分数提升，甲虫速度会越来越快，相应的，玩家在每次过河以及获得道具时，也能获得更高的奖励积分</p>
            <p>玩家在一次过河成功之后，短时间内连续第二次过河，将提升1倍积分奖励，最高可累加至4倍。若连续过河中断，将还原成1倍奖励</p>
            <h2>道具功能</h2>
            <p>石头：阻碍玩家的行进线路</p>
            <p>蓝宝石：使游戏时间变慢，持续5秒</p>
            <p>黄宝石：将所有甲虫移到屏幕的左侧之外</p>
            <p>绿宝石：随机消除1只甲虫，游戏后期可以消除2只甲虫。若当前屏幕内只剩一只甲虫，将改为获得中量积分</p>
            <p>钥匙：随机消除一个石块，同时获得少量积分</p>
            <p>红心：补充一点生命值，如果达到5点的上限，则改为获得中量积分</p>
            <p>五角星：获得大量积分</p>
            <h2>版本更新记录</h2>
            <h4>2017.3.19</h4>
            <ul>
                <li>没起名字的玩家将被随机指定一个小猫小狗的名字</li>
                <li>略微降低中后期甲虫速度的增幅</li>
                <li>降低五角星的得分和满血时红心的积分奖励，小幅增加钥匙的得分</li>
                <li>中后期绿宝石将能一次消除两只甲虫</li>
            </ul>
            <h4>2017.3.22</h4>
            <ul>
                <li>提供语言设置选项，默认为中文</li>
                <li>增加短时间内连续过河积分奖励</li>
                <li>添加游戏说明面板</li>
                <li>提升甲虫升级时的积分门槛，现在除了坚持得够久，玩家还需取得足够多的积分，才能面对更快速的甲虫，从而在单次过河中获得更高的积分</li>
                <li>添加微信分享链接的缩略图</li>
            </ul>
            <h4>2017.3.26</h4>
            <ul>
                <li>全球榜单记录所有数据，本地榜单现在显示个人最佳成绩的世界排名</li>
                <li>将图片资源进行缓存，游戏启动更加迅速</li>
            </ul>
        </div>
        <button id="btn-close-instruction" class="btn-close btn-toggle">OK</button>
    </div>
    <div id="operation-panel" class="operation-panel">
        <button id="arrow-up" class="arrow-up arrow-key">⇧</button>
        <button id="arrow-down" class="arrow-down arrow-key">⇩</button>
        <button id="arrow-left" class="arrow-left arrow-key">⇦</button>
        <button id="arrow-right" class="arrow-right arrow-key">⇨</button>
    </div>

    <script src="https://cdn.wilddog.com/js/client/current/wilddog.js" ></script>

    <!-- <script src="js/resources.js"></script>
    <script src="js/class.js"></script>
    <script src="js/util.js"></script>
    <script src="js/controller.js"></script>
    <script src="js/dommanager.js"></script>
    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
    <script src="js/engine.js"></script> -->

    <!-- <script src="minified/js/main.min.js"></script> -->
    <script>
        !function(){"use strict";function e(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)}function t(e){if(o[e])return o[e];var t=new Image;t.onload=function(){o[e]=t,null===n&&Util.storeImg(t,e),a()&&i.forEach(function(e){e()})},o[e]=!1;var n=Util.getImg(e);t.src=null===n?e:n}function n(e){return o[e]}function a(){var e=!0;for(var t in o)o.hasOwnProperty(t)&&!o[t]&&(e=!1);return e}function r(e){i.push(e)}var o={},i=[];window.Resources={load:e,get:n,onReady:r,isReady:a}}();var Enemy=function(e){"use strict";this.level=e,this.initLocation(),this.sprite="images/enemy-bug.png"};Enemy.prototype.initLocation=function(){"use strict";this.x=-CELL_WIDTH,this.y=CELL_HEIGHT*Math.ceil(4*Math.random());var e=36;e=this.level<36?36+1*this.level:this.level<72?72+.95*(this.level-36):this.level<108?72+36*.95+.88*(this.level-72):this.level<144?137.88+.77*(this.level-108):165.6+.6*(this.level-144),this.speed=e*(2+3*Math.random())},Enemy.prototype.update=function(e){"use strict";this.x+=this.speed*e,this.x>5*CELL_WIDTH&&this.initLocation()},Enemy.prototype.render=function(){"use strict";ctx.drawImage(Resources.get(this.sprite),this.x+20,this.y-20,60,102)};var Entity=function(){"use strict";this.initLocation()};Entity.prototype.initLocation=function(){"use strict";var e,t;do{e=Math.floor(5*Math.random()),t=Math.floor(4*Math.random()),this.x=CELL_WIDTH*e,this.y=CELL_HEIGHT*(t+1)}while(Controller.pavement[t][e]||this.x===player.x&&this.y===player.y);Controller.pavement[t][e]=!0};var Obstacle=function(){"use strict";Entity.call(this),this.sprite="images/Rock.png"};Obstacle.prototype=Object.create(Entity.prototype),Obstacle.prototype.constructor=Obstacle,Obstacle.prototype.render=function(){"use strict";ctx.drawImage(Resources.get(this.sprite),this.x+10,this.y-40,80,136)};var Treasure=function(){"use strict";Entity.call(this)};Treasure.prototype=Object.create(Entity.prototype),Treasure.prototype.constructor=Treasure,Treasure.prototype.render=function(){"use strict";ctx.drawImage(Resources.get(this.sprite),this.x+21,this.y-15,60,102)};var BlueGem=function(){"use strict";Treasure.call(this),this.sprite="images/Gem Blue.png"};BlueGem.prototype=Object.create(Treasure.prototype),BlueGem.prototype.constructor=BlueGem;var GreenGem=function(){"use strict";Treasure.call(this),this.sprite="images/Gem Green.png"};GreenGem.prototype=Object.create(Treasure.prototype),GreenGem.prototype.constructor=GreenGem;var OrangeGem=function(){"use strict";Treasure.call(this),this.sprite="images/Gem Orange.png"};OrangeGem.prototype=Object.create(Treasure.prototype),OrangeGem.prototype.constructor=OrangeGem;var Heart=function(){"use strict";Treasure.call(this),this.sprite="images/Heart.png"};Heart.prototype=Object.create(Treasure.prototype),Heart.prototype.constructor=Heart,Heart.prototype.render=function(){"use strict";ctx.drawImage(Resources.get(this.sprite),this.x+21,this.y-5,60,102)};var Key=function(){"use strict";Treasure.call(this),this.sprite="images/Key.png"};Key.prototype=Object.create(Treasure.prototype),Key.prototype.constructor=Key,Key.prototype.render=function(){"use strict";ctx.drawImage(Resources.get(this.sprite),this.x+12,this.y-30,80,136)};var Star=function(){"use strict";Treasure.call(this),this.sprite="images/Star.png"};Star.prototype=Object.create(Treasure.prototype),Star.prototype.constructor=Star;var Player=function(){"use strict";var e=["images/char-boy.png","images/char-cat-girl.png","images/char-horn-girl.png","images/char-pink-girl.png","images/char-princess-girl.png"],t=Math.floor(Math.random()*e.length);this.sprite=e[t],this.lives=3,this.score=0,this.canMove=!0,this.initLocation()};Player.prototype.initLocation=function(){"use strict";this.x=2*CELL_WIDTH,this.y=5*CELL_HEIGHT},Player.prototype.update=function(){"use strict";this.canMove&&this.hasCollisionWith(allEnemies)&&Controller.collideWithEnemy()},Player.prototype.hasCollisionWith=function(e){"use strict";if(!(e instanceof Array))return console.log("not an array!"),!1;for(var t=0;t<e.length;t++){var n=e[t];if(void 0!==n&&null!==n&&n.hasOwnProperty("x")&&n.hasOwnProperty("y")){if(n instanceof Enemy&&Math.abs(this.x-n.x)<50&&this.y===n.y)return!0;if(n instanceof Obstacle&&this.x===n.x&&this.y===n.y)return!0;if(n instanceof Treasure&&this.x===n.x&&this.y===n.y){n instanceof BlueGem?Controller.obtainBlueGem():n instanceof GreenGem?Controller.obtainGreenGem():n instanceof OrangeGem?Controller.obtainOrangeGem():n instanceof Heart?Controller.obtainHeart():n instanceof Key?Controller.obtainKey():n instanceof Star&&Controller.obtainStar(),e[t]=null,allTreasure=Util.takeOutNullOrUndefined(e);var a=this.y/CELL_HEIGHT-1,r=this.x/CELL_WIDTH;return Controller.pavement[a][r]=!1,!0}}}return!1},Player.prototype.render=function(){"use strict";ctx.drawImage(Resources.get(this.sprite),this.x,this.y-50)},Player.prototype.handleInput=function(e){"use strict";if(this.canMove){var t=this.x,n=this.y;switch(e){case"left":this.x>=CELL_WIDTH&&(this.x-=CELL_WIDTH);break;case"right":this.x<4*CELL_WIDTH&&(this.x+=CELL_WIDTH);break;case"up":this.y>0&&(this.y-=CELL_HEIGHT,this.y<=0&&Controller.crossRiver());break;case"down":this.y<5*CELL_HEIGHT&&(this.y+=CELL_HEIGHT);break;default:return}this.hasCollisionWith(allObstacles)&&(this.x=t,this.y=n),this.hasCollisionWith(allTreasure)}};var Util=function(e){"use strict";var t=function(e){for(var t=[],n=0,a=0;n<e.length;n++)null!==e[n]&&void 0!==e[n]&&(t[a]=e[n],a++);return t},n=function(t){var n=e.localStorage.getItem("frogger_game_"+t);return JSON.parse(n)},a=function(t,n){var a=JSON.stringify(n);e.localStorage.setItem("frogger_game_"+t,a)},r=function(e,t){var r=document.createElement("canvas"),o=r.getContext("2d");r.width=e.width,r.height=e.height,o.drawImage(e,0,0,e.width,e.height);var i=n(t)||{};i.img=r.toDataURL(t),i.time=Date.now(),console.log(t+" 存储到本地");try{a(t,i)}catch(e){console.log("Storage failed: "+e)}},o=function(e){var t=n(e),a=Date.now();return null===t||a-t.time>2592e6?(console.log(e+" 本地没有或者过期"),null):(console.log("成功获取本地文件: "+e),t.img)};return{takeOutNullOrUndefined:t,StorageGetter:n,StorageSetter:a,getImg:o,storeImg:r}}(this),Controller=function(e){"use strict";var t,n,a={treasureNum:2,obstacleNum:2,enemyNum:5,enemyLevel:1},r=function(){var e=[];return e.reset=function(){for(var t=0;t<4;t++){e[t]=[];for(var n=0;n<5;n++)e[t][n]=!1}},e.getOccupiedNum=function(){var e=0;return this.forEach(function(t){t.forEach(function(t){e+=t?1:0})}),e},e.reset(),e}(),o=function(e,t){allEnemies.length>0&&(t=allEnemies[0].level);for(var n=0;n<e;n++)allEnemies.push(new Enemy(t))},i=function(e){for(var t=0;t<e;t++)r.getOccupiedNum()<=10&&allObstacles.push(new Obstacle)},s=function(e,t){for(var n=0;n<e;n++)r.getOccupiedNum()<=12&&allTreasure.push(new t)},l=function(e){var t,n,a=[{ClassName:BlueGem,weight:20},{ClassName:GreenGem,weight:10},{ClassName:OrangeGem,weight:15},{ClassName:Heart,weight:10},{ClassName:Key,weight:10},{ClassName:Star,weight:5}],r=0;for(t=0;t<a.length;t++)r+=a[t].weight;var o,i,l;for(t=0;t<e;t++){for(o=Math.ceil(Math.random()*r),l=a[0].ClassName,i=0,n=0;n<a.length-1;n++)(i+=a[n].weight)<o&&(l=a[n+1].ClassName);s(1,l)}},c=function(){if(0!==allObstacles.length){var e=Math.floor(Math.random()*allObstacles.length),t=allObstacles[e].y/CELL_HEIGHT-1,n=allObstacles[e].x/CELL_WIDTH;r[t][n]=!1,allObstacles[e]=null,allObstacles=Util.takeOutNullOrUndefined(allObstacles)}},g=function(){player.initLocation(),player.lives=3,player.score=0,player.canMove=!0,DomManager.updateLives(),DomManager.updateScore(),DomManager.resetMsg(),DomManager.hideMenu(),y(),D(),DomManager.setProgressBarLength(0),Engine.reset(),h(a.treasureNum,a.obstacleNum,a.enemyNum,a.enemyLevel),f=0,d()},u=function(){player.canMove=!1,Engine.setTimeSpeed(0),C()},m=function(){player.canMove=!0,Engine.setTimeSpeed(1),T>0&&x()},p=function(){y(),D();var t=["Game Over","游戏结束！"];DomManager.setMsg(t[language]),e.setTimeout(function(){var t=Date.now(),n={name:"",score:player.score,role:player.sprite,time:t},a=Data.getLocalList(),r=Data.getRemoteList(),o=r.length<100||n.score>r[99].score,i=a.length<10||n.score>a[9].score,s=["小猫","小狗","小老鼠","小牛","小老虎","小兔子","小羊羔","小猴子","小猪","小熊猫","小苹果"],l=Math.floor(Math.random()*s.length),c="没有名字的"+s[l];if(o){var u=["Congratulations! You've broaded on the global record list!Please leave your name: ","恭喜，你成功登上了全球排行榜！\n请留下你的大名："];n.name=e.prompt(u[language],c)||c,Data.updateRemoteList(n),Data.updateLocalList(n)}else if(i){var m=["You have freshed your own top 10 records!\nPlease leave your name: ","你刷新了个人的10佳记录，可以留个名了："];n.name=e.prompt(m[language],c)||c,Data.updateLocalList(n)}else{var p=["You could do better!","下次努力"];e.alert(p[language])}g()},10)},h=function(e,t,n,a){allEnemies=[],allObstacles=[],allTreasure=[],r.reset(),l(e),i(t),o(n,a)},f=0,d=function(){var n=f;e.clearInterval(t),t=e.setInterval(function(){var e=Engine.getTime()/5,t=1.25*Math.sqrt(player.score);f=Math.floor(Math.min(e,t)),f!==n&&(allEnemies.forEach(function(e){e.level+=1}),l(1),f%3==0&&(allEnemies.length<4&&o(1,f),i(1)),f%4==0&&allEnemies.length<8&&o(1,f),f%6==0&&s(1,Key),f%8==0&&s(1,GreenGem),f%12==0&&s(1,Heart)),n=f},1e3)},y=function(){e.clearInterval(t)},v=0,E=1,M=0,L=function(){e.clearTimeout(M),player.canMove=!1;var t=Date.now();E=t-v<2800?E<4?E+1:4:1;var n=(10+f)*E;player.score+=n,DomManager.updateScore();var a=[];a[0]=["Good Job!","Nice Move!","Well Done!","You Need Water!"],a[1]=["好样的！","身手敏捷！","你的身法让人眼花缭乱","该让甲虫跑得再快一点","甲虫朋友们，碾死他！"];var r=Math.floor(Math.random()*a[language].length),o=["Fast Crossing\n"+E+" * "+n+" Scores Awarded","连续过河! "+E+"倍积分奖励"];E>1?(DomManager.setMsg(o[language]),DomManager.setMsgColor("#fbf850")):DomManager.setMsg(a[language][r]),v=Date.now(),e.setTimeout(function(){player.initLocation(),player.canMove=!0},500),M=e.setTimeout(function(){DomManager.resetMsg()},1500)},I=function(){if(u(),player.lives-=1,DomManager.updateLives(),DomManager.setMsgColor("#f13"),player.lives>0){var t=["Oops! Collide with a bug!","你被甲虫给逮住啦!"];DomManager.setMsg(t[language]),e.setTimeout(function(){DomManager.resetMsg(),player.initLocation(),m()},1500)}else p()},b=function(){T=5e3,x()},T=0,x=function(){Engine.setTimeSpeed(.2);var t=["Time Slowing Down","时间变慢了！"];DomManager.setMsg(t[language]);T=Math.min(5e3,T);e.clearInterval(n),n=e.setInterval(function(){T-=10,T=Math.max(T-10,0),DomManager.setProgressBarLength(T/5e3),T<=0&&(Engine.setTimeSpeed(1),DomManager.resetMsg(),e.clearInterval(n))},10)},C=function(){e.clearInterval(n)},D=function(){e.clearInterval(n),T=0,DomManager.setProgressBarLength(0)},w=function(){if(allEnemies.length<=1){var t=30+2*f;player.score+=t,DomManager.updateScore();var n=[" Scores Awarded!","分到手！"];DomManager.setMsg(t+n[language])}else{var a=allEnemies.length>2&&f>60?2:1;allEnemies=allEnemies.slice(0,allEnemies.length-a);var r=[" Bug Eliminated!","只甲虫被消灭！"];DomManager.setMsg(a+r[language])}e.setTimeout(function(){DomManager.resetMsg()},1500)},G=function(){allEnemies.forEach(function(e){e.x=-200});var t=["Push Bugs Away!!","全部给我闪开！"];DomManager.setMsg(t[language]),e.setTimeout(function(){DomManager.resetMsg()},1500)},k=function(){if(player.lives<5){player.lives+=1,DomManager.updateLives();var t=["One More Life!","奖励1点生命值"];DomManager.setMsg(t[language])}else{var n=50+2*f;player.score+=n,DomManager.updateScore();var a=["分到手！"," Extra Scores"];DomManager.setMsg(player.score+a[language])}e.setTimeout(function(){DomManager.resetMsg()},1500)},B=function(){c(),player.score+=20+Math.floor(.5*f),DomManager.updateScore();var t=["Remove a Rock!","移开了一块石头!"];DomManager.setMsg(t[language]),e.setTimeout(function(){DomManager.resetMsg()},1500)},O=function(){var t=100+3*f;player.score+=t,DomManager.updateScore();var n=[" Scores Awarded!","分到手，好多!"];DomManager.setMsg(t+n[language]),e.setTimeout(function(){DomManager.resetMsg()},1500)};return{pavement:r,initialSettings:a,restartGame:g,pauseGame:u,continueGame:m,crossRiver:L,collideWithEnemy:I,obtainBlueGem:b,obtainGreenGem:w,obtainOrangeGem:G,obtainKey:B,obtainHeart:k,obtainStar:O}}(this);DomManager=function(e){"use strict";var t=e.document,n=t.getElementById("score"),a=t.getElementById("msg"),r=t.getElementById("life"),o=t.getElementById("progress-bar"),i=t.getElementById("top-bar"),s=t.getElementById("btn-menu"),l=t.getElementById("menu"),c=t.getElementById("btn-ranking"),g=t.getElementById("title-world"),u=t.getElementById("title-local"),m=t.getElementById("ranking-board"),p=t.getElementById("remote-list"),h=t.getElementById("local-list"),f=t.getElementById("btn-close-ranking"),d=t.getElementById("btn-instruction"),y=t.getElementById("instruction-board"),v=t.getElementById("btn-close-instruction"),E=t.getElementById("btn-role"),M=t.getElementById("role-list"),L=t.getElementById("btn-language"),I=t.getElementById("language-list"),b=t.getElementById("btn-restart"),T=t.getElementById("operation-panel"),x=t.getElementById("arrow-up"),C=t.getElementById("arrow-down"),D=t.getElementById("arrow-left"),w=t.getElementById("arrow-right"),G=function(){var e=["Frogger","扶小朋友过马路"];t.getElementById("game-title").innerText=e[language];var n=["Ranking","排行榜"];c.innerText=n[language];var a=["Role","角色"];E.innerText=a[language];var r=["Language","语言"];L.innerText=r[language];var o=["Instruction","游戏说明"];d.innerText=o[language];var i=["Restart","重新开始"];b.innerText=i[language];var s=["World","全球榜单"];g.innerText=s[language];var l=["Local","本地榜单"];u.innerText=l[language]},k=function(){var e=["Move to the river above","快到河边来！"];a.innerText=e[language],a.style.color="#fff"},B=function(e){a.innerText=e},O=function(e){a.style.color=e},H=function(){var e=["Score: ","分数: "];n.innerText=e[language]+player.score},S=function(){r.innerText="";for(var e=0;e<player.lives;e++)r.innerText+="♥"},N=function(e){e=Math.max(e,0),e=Math.min(e,1),o.style.width=i.offsetWidth*e+"px"},R=!0,_=function(){l.style.height="303px",l.style.borderBottom="2px solid #251",R=!1,Controller.pauseGame()},P=function(){l.style.height=0,l.style.borderBottom=0,R=!0,Controller.continueGame()},W=!0,U=function(){M.style.width="310px",W=!1},K=function(){M.style.width="0",W=!1},A=!0,j=function(){I.style.width="204px",A=!1},Y=function(){I.style.width="0",A=!1},F=function(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,a=0;a<t.length;a++)if(e.indexOf(t[a])>0){n=!1;break}return n},J=function(){G(),t.addEventListener("keyup",function(e){var t={37:"left",38:"up",39:"right",40:"down"};player.handleInput(t[e.keyCode])}),s.onclick=function(e){e.stopPropagation(),R?_():P()},t.onclick=function(){P(),K(),Y()},m.style.height=t.documentElement.clientHeight+"px";var e,n,a=function(n){var a=t.createElement("li"),r=e%2==0?"odd-row":"even-row";if(a.className="record "+r,"local-"===n&&0===e){a.className="first-record "+r;var o=t.createElement("p");o.className="ranking-detail",o.id="ranking-detail",a.appendChild(o)}var i=t.createElement("p");i.className="record-ranking record-txt",i.id=n+"ranking-"+e;var s=t.createElement("div");s.className="record-role";var l=t.createElement("img");l.className="role-img",l.id=n+"img-"+e,s.appendChild(l);var c=t.createElement("p");c.className="record-name record-txt",c.id=n+"name-"+e;var g=t.createElement("p");return g.className="record-score record-txt",g.id=n+"score-"+e,a.appendChild(i),a.appendChild(s),a.appendChild(c),a.appendChild(g),a};for(e=0;e<100;e++)n=a("remote-"),p.appendChild(n);for(e=0;e<10;e++)n=a("local-"),h.appendChild(n);c.onclick=function(e){e.stopPropagation(),P(),Controller.pauseGame(),m.style.display="block",Data.uploadLocalList();var n=Data.getRemoteList(),a=Data.getLocalList(),r=0,o=0;if(a.length>0&&(o=a[0].score),0!==(r=Data.getRanking(o,n))){var i=t.getElementById("ranking-detail"),s=(n.length-r)/n.length;s=Math.floor(1e4*s)/100,0===language?i.innerText="No."+r+" in world ranking - Above "+s+"% players":1===language&&(i.innerText="全球排名第"+r+"，超过了"+s+"%的玩家")}var l,c,g,u,p,h,f=Math.min(n.length,100);for(l=0;l<f;l++)c=n[l],g=t.getElementById("remote-ranking-"+l),u=t.getElementById("remote-img-"+l),p=t.getElementById("remote-name-"+l),h=t.getElementById("remote-score-"+l),g.innerText=l+1,u.src=c.role||"images/char-boy.png",u.alt=u.src,p.innerText=c.name,h.innerText=c.score;var d=Math.min(a.length,10);for(l=0;l<d;l++)c=a[l],g=t.getElementById("local-ranking-"+l),u=t.getElementById("local-img-"+l),p=t.getElementById("local-name-"+l),h=t.getElementById("local-score-"+l),g.innerText=l+1,u.src=c.role||"images/char-boy.png",u.alt=u.src,p.innerText=c.name,h.innerText=c.score},g.onclick=function(e){e.stopPropagation(),g.style.backgroundColor="#4156a0",u.style.backgroundColor="transparent",p.style.left="0",h.style.left=p.offsetWidth+"px"},u.onclick=function(e){e.stopPropagation(),u.style.backgroundColor="#4156a0",g.style.backgroundColor="transparent",p.style.left=-p.offsetWidth+"px",h.style.left="0"},f.onclick=function(){m.style.display="none"},E.onclick=function(e){e.stopPropagation()},L.onclick=function(e){e.stopPropagation()},E.onmouseover=function(){U()},M.onmouseover=function(){U()},E.onmouseout=function(){K()},M.onmouseout=function(){K()},y.style.height=t.documentElement.clientHeight+"px",d.onclick=function(e){e.stopPropagation(),P(),Controller.pauseGame(),y.style.display="block"},v.onclick=function(){y.style.display="none"};for(var r=["images/char-boy.png","images/char-cat-girl.png","images/char-horn-girl.png","images/char-pink-girl.png","images/char-princess-girl.png"],o=0;o<r.length;o++){var i=t.getElementById("role-"+o);i.src=Util.getImg(r[o]),function(e){i.onclick=function(){player.sprite=r[e],K()}}(o)}L.onmouseover=function(){j()},I.onmouseover=function(){j()},L.onmouseout=function(){Y()},I.onmouseout=function(){Y()};var l=t.getElementById("language-0"),B=t.getElementById("language-1");if(l.onclick=function(){language=0,G(),k(),H(),Util.StorageSetter("language",language)},B.onclick=function(){language=1,G(),k(),H(),Util.StorageSetter("language",language)},b.onclick=function(){Controller.restartGame()},F())T.style.display="none";else{T.style.display="block",x.ontouchstart=function(){player.handleInput("up")},C.ontouchstart=function(){player.handleInput("down")},D.ontouchstart=function(){player.handleInput("left")},w.ontouchstart=function(){player.handleInput("right")},t.addEventListener("touchstart",function(e){e.touches.length>1&&e.preventDefault()});var O=0;t.addEventListener("touchend",function(e){var t=(new Date).getTime();t-O<=500&&e.preventDefault(),O=t},!1)}};return{resetMsg:k,setMsg:B,setMsgColor:O,updateScore:H,updateLives:S,setProgressBarLength:N,hideMenu:P,addEventListener:J}}(this);var Data=function(e){"use strict";var t=new Wilddog("https://frogger.wilddogio.com/records"),n=[],a={};t.on("child_added",function(e){var t=e.val();a={name:t.name,score:t.score,role:t.role,time:t.time},n.push(a)});var r=function(){return n.sort(function(e,t){return t.score-e.score})},o=function(e){t.push(e)},i=function(){return Util.StorageGetter("topList")||[]},s=function(e){var t=i();t.push(e),t.sort(function(e,t){return t.score-e.score}),t=t.slice(0,10),Util.StorageSetter("topList",t)},l=function(){i().forEach(function(e){c(e)&&o(e)})},c=function(e){var t=r();if(0===t.length)return!1;for(var n=0;n<t.length;n++)if(t[n].time===e.time)return!1;return 0!==e.score},g=function(e,t){if(!(t instanceof Array)||0===t.length||0===e)return 0;for(var n=0;n<t.length;n++)if(t[n].score<=e)return n+1};return{getRemoteList:r,updateRemoteList:o,getLocalList:i,updateLocalList:s,uploadLocalList:l,getRanking:g}}(),CELL_WIDTH=101,CELL_HEIGHT=83,player=new Player,allEnemies=[],allObstacles=[],allTreasure=[],language=Util.StorageGetter("language");void 0!==language&&null!==language||(language=1);var Engine=function(e){"use strict";function t(){var e=Date.now(),n=(e-g)/1e3*d;a(n),o(),g=e,u+=n,p.requestAnimationFrame(t)}function n(){Controller.restartGame(),DomManager.addEventListener(),g=Date.now(),t()}function a(e){r(e)}function r(e){allEnemies.forEach(function(t){t.update(e)}),player.update()}function o(){var e,t,n=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png"];for(e=0;e<6;e++)for(t=0;t<5;t++)f.drawImage(Resources.get(n[e]),t*CELL_WIDTH,e*CELL_HEIGHT-40);i()}function i(){allEnemies.forEach(function(e){e.render()}),allObstacles.forEach(function(e){e.render()}),allTreasure.forEach(function(e){e.render()}),player.render()}function s(){u=0,c(1)}function l(){return u}function c(e){d=e}var g,u,m=e.document,p=e.window,h=m.createElement("canvas"),f=h.getContext("2d"),d=1;return h.width=5*CELL_WIDTH,h.height=6.8*CELL_HEIGHT,m.body.appendChild(h),h.style.marginTop="-11px",Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-boy.png","images/char-cat-girl.png","images/char-horn-girl.png","images/char-pink-girl.png","images/char-princess-girl.png","images/Rock.png","images/Gem Blue.png","images/Gem Green.png","images/Gem Orange.png","images/Heart.png","images/Key.png","images/Star.png"]),Resources.onReady(n),e.ctx=f,{reset:s,getTime:l,setTimeSpeed:c}}(this);
    </script>

</body>
</html>
